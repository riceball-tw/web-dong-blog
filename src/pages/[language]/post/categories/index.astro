---
import { getRelativeLocaleUrl } from "astro:i18n";
import Container from "@/components/atoms/container/Container.astro";
import SpotlightCard from "@/components/atoms/spotlight-card/SpotlightCard.astro";
import SpotlightCardsGallery from "@/components/atoms/spotlight-cards-gallery/SpotlightCardsGallery.astro";
import Hero from "@/components/molecules/hero/Hero.astro";
import BlogBase from "@/layouts/BlogBase.astro";
import * as m from "@/paraglide/messages";
import { sortedPostCategoryies } from "@/utils/getPosts.ts";
import { defaultLocale, languages } from "@/utils/i18n.ts";
import toSnakeCase from "@/utils/toSnakeCase.ts";

export function getStaticPaths() {
	return Object.keys(languages).map((language) => ({
		params: { language },
	}));
}
---

<BlogBase title={m.salty_kind_crossbill_support()} description={m.swift_sweet_tiger_gasp()}>
  <Hero>
    <Fragment slot="headline">{m.that_cuddly_oryx_play({number: sortedPostCategoryies.length})}</Fragment>
  </Hero>

  <Container>
    <SpotlightCardsGallery>
      {
        sortedPostCategoryies.map((category) => (
          <ul>
            <li class="text-3xl">
              <SpotlightCard>
                <a data-cy="category-link" data-astro-prefetch 
                href={getRelativeLocaleUrl(Astro.currentLocale || defaultLocale, `/post/categories/${category}/`)}>
                               {
                        (() => {
                          const snakedCategoryType = toSnakeCase(category)
                          const categoryI18nMethodName = `category_${snakedCategoryType}`;
                          const categoryI18n = m[categoryI18nMethodName as keyof typeof m] as () => string;
                          if (typeof categoryI18n === 'function') {
                            return categoryI18n();
                          }
                          // eslint-disable-next-line no-console
                          console.warn(`Category translation not found: ${category}`);
                          return category;
                        })()
                      }
                  </a>
              </SpotlightCard>
            </li>
          </ul>
        ))
      }
    </SpotlightCardsGallery>
  </Container>
</BlogBase>